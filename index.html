<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <!-- CSP –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ csp-manager.js —Å nonce-based security -->
  
  <!-- Favicon -->
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="alternate icon" href="/favicon.ico" type="image/x-icon">
  
  <title>oshu://work v0.1 - Telegram Mini App</title>
  <!-- Preload –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ First Paint -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://lwfhtwnfqmdjwzrdznvv.supabase.co">
  
  <!-- Preload handled by Vite automatically -->
  
  <!-- Critical CSS –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ First Paint -->
  <link rel="stylesheet" href="src/css/critical.css">
  
  <!-- –£–º–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –º–µ—Ä—Ü–∞–Ω–∏—è -->
  <script>
    (function() {
      const savedTheme = localStorage.getItem('app-theme');
      if (savedTheme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º–Ω—É—é —Ç–µ–º—É —Å—Ä–∞–∑—É
        document.documentElement.style.setProperty('--background-color', '#121212');
        document.documentElement.style.setProperty('--card-color', '#1E1E1E');
        document.documentElement.style.setProperty('--text-color', '#E8E8E8');
        document.documentElement.style.setProperty('--border-color', '#333333');
      } else {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
  
  <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ (—É–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ preload) -->
  <link rel="stylesheet" href="src/css/style.css">
  
  <!-- Fonts loaded asynchronously with optimal loading -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@500;700&family=Press+Start+2P&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@500;700&family=Press+Start+2P&display=swap"></noscript>
</head>
<body>

<div class="main-wrapper">
  <div class="ptr-bar"><div class="ptr-text">–ü–æ—Ç—è–Ω–∏—Ç–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</div></div>
  
  <div id="main-header">
    <header class="header">
      <h1>oshu://work <small>v0.1</small></h1>
      <div id="header-actions" class="header-actions">
        <a href="favorites.html" class="header-button telegram-haptic">‚òÖ –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
        <a href="settings.html" class="header-button telegram-haptic">‚öôÔ∏é –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
      </div>
    </header>
    <div id="search-container" class="search-container">
      <div class="search-input-wrapper">
        <input type="search" id="search-input" class="search-input" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –∫–æ–º–ø–∞–Ω–∏–∏, –∑–∞—Ä–ø–ª–∞—Ç–µ...">
        <button id="search-clear-btn" class="search-clear-btn" aria-label="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫"></button>
      </div>
    </div>
  </div>

  <main class="content" id="vacancies-content">
    <div id="vacancies-list-main" class="vacancy-list active" role="tabpanel" aria-labelledby="tab-main" aria-label="–í–∞–∫–∞–Ω—Å–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ—á–Ω–æ —Ç–≤–æ—ë"></div>
    <div id="vacancies-list-maybe" class="vacancy-list" role="tabpanel" aria-labelledby="tab-maybe" aria-label="–í–∞–∫–∞–Ω—Å–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –ú–æ–∂–µ—Ç –±—ã—Ç—å" aria-hidden="true"></div>
    <div id="vacancies-list-other" class="vacancy-list" role="tabpanel" aria-labelledby="tab-other" aria-label="–í–∞–∫–∞–Ω—Å–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –ù–µ —Ç–≤–æ—ë" aria-hidden="true"></div>
  </main>
</div>

<div id="loader" class="loader-container hidden">
  <div class="retro-progress-bar-outline">
    <div class="retro-progress-bar-fill"></div>
  </div>
  <div class="loader-text">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π...</div>
</div>

<div id="category-tabs" class="category-tabs" role="tablist" aria-label="–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–∞–∫–∞–Ω—Å–∏–π">
    <button id="tab-main" class="tab-button main active" data-target="vacancies-list-main" data-category-name="–¢–û–ß–ù–û –¢–í–û–Å" 
          role="tab" aria-selected="true" aria-controls="vacancies-list-main">
    <span class="tab-label">–¢–û–ß–ù–û –¢–í–û–Å</span>
    <span id="count-main" class="tab-count">0</span>
  </button>
  <button id="tab-maybe" class="tab-button maybe" data-target="vacancies-list-maybe" data-category-name="–ú–û–ñ–ï–¢ –ë–´–¢–¨"
          role="tab" aria-selected="false" aria-controls="vacancies-list-maybe">
    <span class="tab-label">–ú–û–ñ–ï–¢ –ë–´–¢–¨</span>
    <span id="count-maybe" class="tab-count">0</span>
  </button>
  <button id="tab-other" class="tab-button other" data-target="vacancies-list-other" data-category-name="–ù–ï –¢–í–û–Å"
          role="tab" aria-selected="false" aria-controls="vacancies-list-other">
    <span class="tab-label">–ù–ï –¢–í–û–Å</span>
    <span id="count-other" class="tab-count">0</span>
  </button>
</div>

<div id="custom-confirm-overlay" class="custom-confirm-overlay hidden">
    <div class="custom-confirm-box">
    <p id="custom-confirm-text"></p>
    <div class="custom-confirm-actions">
      <button id="confirm-btn-cancel" class="custom-confirm-button" aria-label="–û—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ">–û—Ç–º–µ–Ω–∞</button>
      <button id="confirm-btn-ok" class="custom-confirm-button ok" aria-label="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ">OK</button>
    </div>
  </div>
</div>

<div id="toast-container" class="toast-container"></div>

<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—â–µ–≥–æ template -->
<template id="vacancy-card-template">
    <div class="vacancy-card">
    <div class="card-actions">
      <button class="card-action-btn apply" data-element="apply-btn" aria-label="–û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><title>–û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é</title><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22,2 15,22 11,13 2,9"/></svg>
      </button>
      <button class="card-action-btn favorite" data-element="favorite-btn" aria-label="–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><title>–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</title><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"/></svg>
      </button>
      <button class="card-action-btn delete" data-element="delete-btn" aria-label="–£–¥–∞–ª–∏—Ç—å">
        <svg width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><title>–£–¥–∞–ª–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é</title><path d="M18 6L6 18M6 6l12 12"/></svg>
      </button>
    </div>
    <div class="card-header">
      <h3 data-element="category">NO_CATEGORY</h3>
    </div>
    <div class="card-body">
      <p class="card-summary" data-element="summary"></p>
      <div class="info-window" data-element="info-window"></div>
      <details data-element="details">
        <summary>–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç</summary>
        <div class="vacancy-text">
            <div class="attachments" data-element="attachments"></div>
            <div data-element="full-text"></div>
        </div>
      </details>
    </div>
    <div class="card-footer">
      <div class="footer-skill-tags" data-element="skills"></div>
      <div class="footer-meta">
        <span class="channel-name" data-element="channel"></span>
        <span class="meta-separator"> ‚Ä¢ </span>
        <span class="timestamp-footer" data-element="timestamp"></span>
      </div>
    </div>
  </div>
</template>

<!-- Telegram WebApp API - –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–≤—ã–º –¥–ª—è Phase 3 -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- Phase 3: Telegram Mini App optimizations -->
<script>
// Preload optimizations –¥–ª—è Telegram Mini App
if (window.Telegram?.WebApp) {
  // –†–∞—Å—à–∏—Ä—è–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω —Å—Ä–∞–∑—É
  window.Telegram.WebApp.expand();
  
  // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É –±—ã—Å—Ç—Ä–æ —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å flash
  const tg = window.Telegram.WebApp;
  if (tg.themeParams.bg_color) {
    document.documentElement.style.setProperty('--tg-bg-color', tg.themeParams.bg_color);
    document.body.style.backgroundColor = tg.themeParams.bg_color;
  }
}
</script>

<!-- Supabase SDK - UMD build –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- Supabase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ env-dev.js -->

<script>
// Fallback –∑–∞–≥—Ä—É–∑–∫–∞ interact.js
(function() {
  function loadScript(url, callback) {
    const script = document.createElement('script');
    script.src = url;
    script.onload = () => {
      window.dispatchEvent(new CustomEvent('interactLoaded'));
      callback(true);
    };
    script.onerror = () => callback(false);
    document.head.appendChild(script);
  }

  // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ CDN (–Ω–∞—á–∏–Ω–∞–µ–º —Å —Å–∞–º–æ–≥–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ)
  const cdnUrls = [
    'https://unpkg.com/interactjs@1.10.11/dist/interact.min.js',
    'https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.10.11/interact.min.js',
    'https://cdn.interactjs.io/v1.10.11/interact.min.js'
  ];

  function tryNextCdn(index = 0) {
    if (index >= cdnUrls.length) return;
    loadScript(cdnUrls[index], (success) => {
      if (!success) tryNextCdn(index + 1);
    });
  }

  tryNextCdn();
})();
</script>
<!-- Entry point - ES –º–æ–¥—É–ª—å -->
<script>
console.log('üîß [HTML] –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å ES –º–æ–¥—É–ª—å main.js...');
</script>
<script type="module" src="./src/js/main.js" 
        onload="console.log('‚úÖ [HTML] ES –º–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω!')" 
        onerror="console.error('‚ùå [HTML] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ES –º–æ–¥—É–ª—è!')"></script>


<!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è CSP –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  if (window.cspManager) {
    window.cspManager.init();
  }
});
</script>
</body>
</html>
